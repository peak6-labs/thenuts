import{i as t}from"./main-DEXK9nnN.js";class e{constructor(t){this.config=t,this.state=this.createInitialState()}createInitialState(){return{currentRound:0,totalRounds:this.config.rounds,score:0,streak:0,bestStreak:0,timeRemaining:this.config.timeLimit,isComplete:!1,isPaused:!1,mistakes:0}}getState(){return{...this.state}}setState(t){this.state={...this.state,...t}}reset(){this.state=this.createInitialState()}nextRound(){return this.state.currentRound>=this.state.totalRounds?(this.state.isComplete=!0,!1):(this.state.currentRound++,!0)}incrementScore(){this.state.score++,this.state.streak++,this.state.bestStreak=Math.max(this.state.bestStreak,this.state.streak)}recordMistake(){this.state.mistakes++,this.state.streak=0}pause(){this.state.isPaused=!0}resume(){this.state.isPaused=!1}complete(){this.state.isComplete=!0}isComplete(){return this.state.isComplete}isPaused(){return this.state.isPaused}serialize(){return{...this.state}}deserialize(t){this.state={...t}}}const n="poker-training-",s={HIGH_SCORES:`${n}high-scores`,GAME_PROGRESS:`${n}game-progress`,COMPLETED_LEVELS:`${n}completed-levels`};function i(){try{const t="__localStorage_test__";return localStorage.setItem(t,"test"),localStorage.removeItem(t),!0}catch{return!1}}function a(t,e){if(!i())return e;try{const n=localStorage.getItem(t);return null===n?e:JSON.parse(n)}catch(n){return e}}function r(t,e){if(!i())return!1;try{return localStorage.setItem(t,JSON.stringify(e)),!0}catch(n){return!1}}function o(){return a(s.HIGH_SCORES,{})}function c(t,e){const n=function(t){return o()[t]||null}(t);return!n||e>n.score}function l(t){const e=a(s.GAME_PROGRESS,{gamesPlayed:{},highScores:{},achievements:[],totalPlayTime:0});e.gamesPlayed[t]=(e.gamesPlayed[t]||0)+1,r(s.GAME_PROGRESS,e)}function h(){const t=a(s.COMPLETED_LEVELS,[]);return new Set(t)}function d(t){const e=h();return e.add(t),r(s.COMPLETED_LEVELS,Array.from(e))}class m{constructor(t){this.answers=[],this.startTime=0,this.gameName=t}startTracking(){this.startTime=Date.now(),this.answers=[]}recordAnswer(t,e,n){this.answers.push({answer:t,isCorrect:e,timestamp:Date.now(),timeToAnswer:n})}getAnswers(){return[...this.answers]}calculateResult(t){const e=Math.floor((Date.now()-this.startTime)/1e3);return{score:t.score,totalRounds:t.totalRounds,accuracy:t.totalRounds>0?t.score/t.totalRounds:0,timeElapsed:e,bestStreak:t.bestStreak,mistakes:t.mistakes}}saveIfHighScore(t){const e=this.calculateResult(t);return!!c(this.gameName,e.score)&&(function(t,e){const n=o();n[t]=e,r(s.HIGH_SCORES,n)}(this.gameName,{game:this.gameName,score:e.score,accuracy:e.accuracy,date:(new Date).toISOString(),timeElapsed:e.timeElapsed}),!0)}recordGamePlayed(){l(this.gameName)}formatTime(t){return`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`}getAccuracyPercent(t){return Math.round(100*t.accuracy)}reset(){this.answers=[],this.startTime=0}serialize(){return{answers:this.answers,startTime:this.startTime}}deserialize(t){this.answers=t.answers||[],this.startTime=t.startTime||0}}class p{constructor(t){this.startTime=0,this.intervalId=null,this.isPaused=!1,this.pausedElapsedTime=0,this.pauseStartTime=null,this.element=null,this.options={format:"seconds",showWarning:!0,warningThreshold:10,allowPause:!1,...t},this.duration=t.duration,this.remaining=t.duration}attachTo(t){this.element="string"==typeof t?document.getElementById(t):t,this.element&&this.options.allowPause&&(this.element.style.cursor="pointer",this.element.title="Click to pause/unpause",this.element.addEventListener("click",()=>this.toggle())),this.updateDisplay()}start(){this.intervalId||(this.startTime=Date.now(),this.intervalId=window.setInterval(()=>this.tick(),100),this.updateDisplay())}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}pause(){!this.isPaused&&this.intervalId&&(this.isPaused=!0,this.pauseStartTime=Date.now(),this.stop(),this.element&&this.element.classList.add("paused"),this.updateDisplay())}resume(){this.isPaused&&(this.isPaused=!1,this.pauseStartTime&&(this.pausedElapsedTime+=Date.now()-this.pauseStartTime,this.pauseStartTime=null),this.element&&this.element.classList.remove("paused"),this.start())}toggle(){this.isPaused?this.resume():this.pause()}reset(){this.stop(),this.remaining=this.duration,this.isPaused=!1,this.pausedElapsedTime=0,this.pauseStartTime=null,this.startTime=0,this.element&&this.element.classList.remove("paused","warning","expired"),this.updateDisplay()}getRemaining(){return Math.max(0,this.remaining)}getElapsed(){if(!this.startTime)return 0;return((this.isPaused&&this.pauseStartTime?this.pauseStartTime:Date.now())-this.startTime-this.pausedElapsedTime)/1e3}isExpired(){return this.remaining<=0}tick(){const t=this.getElapsed();this.remaining=Math.max(0,this.duration-t),this.options.onTick&&this.options.onTick(this.remaining),this.updateDisplay(),this.remaining<=0&&(this.stop(),this.element&&this.element.classList.add("expired"),this.options.onComplete&&this.options.onComplete())}updateDisplay(){if(!this.element)return;const t=this.formatTime(this.remaining),e=this.isPaused?" ⏸":"";this.element.textContent=t+e,this.options.showWarning&&this.remaining<=this.options.warningThreshold&&this.remaining>0?this.element.classList.add("warning"):this.element.classList.remove("warning")}formatTime(t){if("mm:ss"===this.options.format){return`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`}return t.toFixed(1)+"s"}destroy(){this.stop(),this.element&&(this.element.classList.remove("paused","warning","expired"),this.options.allowPause&&(this.element.style.cursor="",this.element.title=""))}setTimeRemaining(t){this.remaining=t,this.duration=t,this.updateDisplay()}}class u{constructor(t){this.options={showStreak:!1,showAccuracy:!1,...t},this.element=this.createElement(),this.update()}createElement(){const t=document.createElement("div");return t.className=`score-display ${this.options.className||""}`,t}update(t){t&&(this.options={...this.options,...t});const e=[`<span class="score-current">${this.options.current}</span>`,"/",`<span class="score-total">${this.options.total}</span>`];if(this.options.showStreak&&void 0!==this.options.streak&&e.push(`<span class="score-streak">Streak: ${this.options.streak}</span>`),this.options.showAccuracy&&void 0!==this.options.accuracy){const t=Math.round(100*this.options.accuracy);e.push(`<span class="score-accuracy">${t}%</span>`)}this.element&&(this.element.innerHTML=e.join(" "))}incrementScore(){this.options.current++,void 0!==this.options.streak&&this.options.streak++,this.updateAccuracy(),this.update()}resetStreak(){void 0!==this.options.streak&&(this.options.streak=0,this.update())}updateAccuracy(){this.options.showAccuracy&&this.options.total>0&&(this.options.accuracy=this.options.current/this.options.total)}attachTo(t){const e="string"==typeof t?document.getElementById(t):t;e?e.appendChild(this.element):"object"==typeof t&&t&&t.appendChild(this.element)}getElement(){return this.element}reset(){this.options.current=0,this.options.streak=0,this.options.accuracy=0,this.update()}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element)}}class g{constructor(t){this.isOpen=!1,this.options={closeOnBackdrop:!0,closeOnEscape:!0,...t},this.container=this.createModalStructure(),this.backdrop=this.container.querySelector(".modal-backdrop"),this.setupEventListeners()}createModalStructure(){const t=document.createElement("div");t.className=`modal ${this.options.className||""}`,t.innerHTML=`\n      <div class="modal-backdrop"></div>\n      <div class="modal-content">\n        <div class="modal-header">\n          <h2 class="modal-title">${this.options.title}</h2>\n          <button class="modal-close" aria-label="Close">&times;</button>\n        </div>\n        <div class="modal-body"></div>\n        <div class="modal-footer"></div>\n      </div>\n    `;const e=t.querySelector(".modal-body");if("string"==typeof this.options.content?e.innerHTML=this.options.content:e.appendChild(this.options.content),this.options.buttons&&this.options.buttons.length>0){const e=t.querySelector(".modal-footer");this.options.buttons.forEach(t=>{const n=this.createButton(t);e.appendChild(n)})}else t.querySelector(".modal-footer").remove();return t}createButton(t){const e=document.createElement("button");return e.textContent=t.text,e.className=`modal-button ${t.className||""} ${t.isPrimary?"primary":""}`,e.addEventListener("click",()=>{t.onClick(),t.className?.includes("no-close")||this.close()}),e}setupEventListeners(){const t=this.container.querySelector(".modal-close");t&&t.addEventListener("click",()=>this.close()),this.options.closeOnBackdrop&&this.backdrop.addEventListener("click",()=>this.close()),this.options.closeOnEscape&&(this.handleEscape=this.handleEscape.bind(this))}handleEscape(t){"Escape"===t.key&&this.isOpen&&this.close()}open(){if(this.isOpen)return;document.querySelectorAll(".modal").forEach(t=>{t.parentNode&&t.parentNode.removeChild(t)}),document.body.appendChild(this.container),this.container.offsetHeight,this.container.classList.add("active"),this.isOpen=!0,this.options.closeOnEscape&&document.addEventListener("keydown",this.handleEscape),this.options.onOpen&&this.options.onOpen()}close(){this.isOpen&&(this.container.classList.remove("active"),this.isOpen=!1,this.options.closeOnEscape&&document.removeEventListener("keydown",this.handleEscape),setTimeout(()=>{this.container.parentNode&&this.container.parentNode.removeChild(this.container)},300),this.options.onClose&&this.options.onClose())}setContent(t){const e=this.container.querySelector(".modal-body");"string"==typeof t?e.innerHTML=t:(e.innerHTML="",e.appendChild(t))}destroy(){this.close(),this.options.closeOnEscape&&document.removeEventListener("keydown",this.handleEscape)}static confirm(t,e,n,s){const i=new g({title:t,content:e,buttons:[{text:"Cancel",onClick:()=>{s&&s()}},{text:"Confirm",onClick:n,isPrimary:!0}]});return i.open(),i}static alert(t,e,n){const s=new g({title:t,content:e,buttons:[{text:"OK",onClick:()=>{n&&n()},isPrimary:!0}]});return s.open(),s}}const f={primary:"#7D1346",secondary:"#C73E9A",secondaryLight:"#FF6EC7",text:"#333",textLight:"#666",buttonGradient:"linear-gradient(135deg, #FF6EC7 0%, #C73E9A 100%)",buttonHover:"linear-gradient(135deg, #C73E9A 0%, #FF6EC7 100%)"};function y(){if(document.getElementById("game-theme-styles"))return;const t=document.createElement("style");t.id="game-theme-styles",t.textContent=`\n    /* Loading screen styles */\n    .game-loading {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      min-height: 400px;\n      color: ${f.primary};\n    }\n    \n    .loading-spinner {\n      width: 80px;\n      height: 80px;\n      margin-bottom: 20px;\n      position: relative;\n    }\n    \n    .loading-card {\n      position: absolute;\n      width: 40px;\n      height: 56px;\n      background: linear-gradient(135deg, ${f.secondary}, ${f.secondaryLight});\n      border-radius: 4px;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.2);\n      animation: shuffleCards 2s infinite ease-in-out;\n    }\n    \n    .loading-card:nth-child(1) {\n      animation-delay: 0s;\n      transform-origin: center bottom;\n    }\n    \n    .loading-card:nth-child(2) {\n      animation-delay: 0.2s;\n      transform-origin: center bottom;\n    }\n    \n    .loading-card:nth-child(3) {\n      animation-delay: 0.4s;\n      transform-origin: center bottom;\n    }\n    \n    .loading-card:nth-child(4) {\n      animation-delay: 0.6s;\n      transform-origin: center bottom;\n    }\n    \n    @keyframes shuffleCards {\n      0%, 100% {\n        transform: rotate(0deg) translateX(0);\n        opacity: 0.8;\n      }\n      25% {\n        transform: rotate(-15deg) translateX(-20px);\n        opacity: 1;\n      }\n      50% {\n        transform: rotate(0deg) translateX(0) translateY(-10px);\n        opacity: 1;\n      }\n      75% {\n        transform: rotate(15deg) translateX(20px);\n        opacity: 1;\n      }\n    }\n    \n    .loading-text {\n      font-size: 24px;\n      font-weight: 600;\n      margin-bottom: 10px;\n      animation: pulse 1.5s infinite ease-in-out;\n    }\n    \n    .loading-subtext {\n      font-size: 14px;\n      color: ${f.textLight};\n      animation: fadeInOut 2s infinite ease-in-out;\n    }\n    \n    @keyframes pulse {\n      0%, 100% {\n        opacity: 0.8;\n      }\n      50% {\n        opacity: 1;\n      }\n    }\n    \n    @keyframes fadeInOut {\n      0%, 100% {\n        opacity: 0.5;\n      }\n      50% {\n        opacity: 1;\n      }\n    }\n    \n    /* Game container styles */\n    .game-container {\n      background: white;\n      border-radius: 12px;\n      padding: 20px;\n      box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n    }\n    \n    /* Choice buttons with Poker Power colors */\n    .choice-btn {\n      background: ${f.buttonGradient};\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      margin: 5px;\n      border-radius: 8px;\n      font-size: 16px;\n      font-weight: 600;\n      cursor: pointer;\n      transition: all 0.3s ease;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    \n    .choice-btn:hover:not(:disabled) {\n      background: ${f.buttonHover};\n      transform: translateY(-2px);\n      box-shadow: 0 4px 8px rgba(0,0,0,0.15);\n    }\n    \n    .choice-btn:disabled {\n      opacity: 0.6;\n      cursor: not-allowed;\n      transform: none;\n    }\n    \n    .choice-btn.correct {\n      background: linear-gradient(135deg, #4caf50, #66bb6a);\n    }\n    \n    .choice-btn.incorrect {\n      background: linear-gradient(135deg, #f44336, #ef5350);\n    }\n    \n    /* Score display */\n    .score-display {\n      background: rgba(125, 19, 70, 0.1);\n      padding: 8px 16px;\n      border-radius: 8px;\n      font-weight: 600;\n      color: ${f.primary};\n    }\n    \n    /* Timer with warning states */\n    .timer-display {\n      background: rgba(125, 19, 70, 0.1);\n      color: ${f.primary};\n      font-weight: 700;\n    }\n    \n    .timer-display.warning {\n      background: #FFEBEE;\n      color: #D32F2F;\n    }\n    \n    /* Headers and text */\n    h1, h2, h3 {\n      color: ${f.primary};\n    }\n    \n    .question {\n      color: ${f.text};\n      font-size: 18px;\n      font-weight: 600;\n      margin: 20px 0;\n      text-align: center;\n    }\n    \n    /* Level badges */\n    .level-badge {\n      background: ${f.buttonGradient};\n      color: white;\n      padding: 6px 12px;\n      border-radius: 20px;\n      font-size: 12px;\n      font-weight: 600;\n      text-transform: uppercase;\n      display: inline-block;\n    }\n    \n    /* Feedback messages */\n    .feedback {\n      padding: 15px;\n      border-radius: 8px;\n      margin: 15px 0;\n      font-weight: 600;\n      text-align: center;\n    }\n    \n    .feedback.correct {\n      background: #e8f5e9;\n      color: #2e7d32;\n      border: 2px solid #4caf50;\n    }\n    \n    .feedback.incorrect {\n      background: #ffebee;\n      color: #c62828;\n      border: 2px solid #f44336;\n    }\n    \n    /* Card selection */\n    .card.selected {\n      border: 3px solid ${f.secondary};\n      transform: translateY(-5px);\n      box-shadow: 0 4px 8px rgba(199, 62, 154, 0.3);\n    }\n    \n    /* Next button */\n    .next-btn {\n      background: ${f.buttonGradient};\n      color: white;\n      border: none;\n      padding: 12px 32px;\n      border-radius: 8px;\n      font-size: 16px;\n      font-weight: 600;\n      cursor: pointer;\n      transition: all 0.3s ease;\n      margin: 20px auto;\n      display: block;\n    }\n    \n    .next-btn:hover {\n      background: ${f.buttonHover};\n      transform: translateY(-2px);\n      box-shadow: 0 4px 8px rgba(0,0,0,0.15);\n    }\n    \n    /* VS divider for Hand vs Hand */\n    .vs-divider {\n      font-size: 24px;\n      font-weight: 700;\n      color: ${f.primary};\n      margin: 0 20px;\n      align-self: center;\n    }\n    \n    /* Hand display sections */\n    .hand-display {\n      text-align: center;\n      padding: 20px;\n      background: rgba(125, 19, 70, 0.05);\n      border-radius: 8px;\n      margin: 10px;\n    }\n    \n    .hand-display h3 {\n      margin-bottom: 15px;\n      color: ${f.primary};\n    }\n  `,document.head.appendChild(t)}class b{constructor(t){this.components={timer:null,scoreDisplay:null,container:null,gameArea:null},this.config=t}setupUI(e,n,s){t(),function(){if(document.getElementById("modal-default-styles"))return;const t=document.createElement("style");t.id="modal-default-styles",t.textContent="\n    .modal {\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      z-index: 9999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      opacity: 0;\n      visibility: hidden;\n      transition: opacity 0.3s, visibility 0.3s;\n    }\n    \n    .modal.active {\n      opacity: 1;\n      visibility: visible;\n    }\n    \n    .modal-backdrop {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.5);\n    }\n    \n    .modal-content {\n      position: relative;\n      background: white;\n      border-radius: 12px;\n      max-width: 500px;\n      width: 90%;\n      max-height: 90vh;\n      overflow: auto;\n      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n      transform: scale(0.9);\n      transition: transform 0.3s;\n    }\n    \n    .modal.active .modal-content {\n      transform: scale(1);\n    }\n    \n    .modal-header {\n      padding: 20px;\n      border-bottom: 1px solid #e0e0e0;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n    \n    .modal-title {\n      margin: 0;\n      font-size: 1.5em;\n      color: #333;\n    }\n    \n    .modal-close {\n      background: none;\n      border: none;\n      font-size: 28px;\n      cursor: pointer;\n      color: #999;\n      line-height: 1;\n      padding: 0;\n      width: 30px;\n      height: 30px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    \n    .modal-close:hover {\n      color: #333;\n    }\n    \n    .modal-body {\n      padding: 20px;\n    }\n    \n    .modal-footer {\n      padding: 20px;\n      border-top: 1px solid #e0e0e0;\n      display: flex;\n      justify-content: flex-end;\n      gap: 10px;\n    }\n    \n    .modal-button {\n      padding: 10px 20px;\n      border: 1px solid #ddd;\n      border-radius: 6px;\n      background: white;\n      cursor: pointer;\n      font-size: 14px;\n      transition: all 0.2s;\n    }\n    \n    .modal-button:hover {\n      background: #f5f5f5;\n    }\n    \n    .modal-button.primary {\n      background: #C73E9A;\n      color: white;\n      border-color: #C73E9A;\n    }\n    \n    .modal-button.primary:hover {\n      background: #932153;\n      border-color: #932153;\n    }\n  ",document.head.appendChild(t)}(),y(),e.innerHTML="",this.cleanup(),this.components.container=e;const i=document.createElement("div");if(i.className="game-header",this.components.scoreDisplay=new u({current:n.score,total:n.totalRounds,showStreak:!0,streak:n.streak}),i.appendChild(this.components.scoreDisplay.getElement()),this.config.timeLimit){this.components.timer=new p({duration:this.config.timeLimit,onComplete:s,allowPause:!0});const t=document.createElement("div");t.id="game-timer",t.className="timer-display",i.appendChild(t),this.components.timer.attachTo(t)}e.appendChild(i);const a=document.createElement("div");return a.className="game-area",a.id="game-area",e.appendChild(a),this.components.gameArea=a,this.components}updateScore(t,e,n){this.components.scoreDisplay&&this.components.scoreDisplay.update({current:t,total:e,streak:n})}incrementScore(){this.components.scoreDisplay&&this.components.scoreDisplay.incrementScore()}resetStreak(){this.components.scoreDisplay&&this.components.scoreDisplay.resetStreak()}startTimer(){this.components.timer&&this.components.timer.start()}pauseTimer(){this.components.timer&&this.components.timer.pause()}resumeTimer(){this.components.timer&&this.components.timer.resume()}resetTimer(){this.components.timer&&this.components.timer.reset()}stopTimer(){this.components.timer&&this.components.timer.stop()}getTimerRemaining(){return this.components.timer?this.components.timer.getRemaining():0}setTimerRemaining(t){this.components.timer&&this.components.timer.setTimeRemaining(t)}showResults(t,e,n){const s=Math.round(100*t.accuracy);new g({title:"Game Complete!",content:`\n        <div class="results-content">\n          <h3>Score: ${t.score}/${t.totalRounds}</h3>\n          <p>Accuracy: ${s}%</p>\n          <p>Best Streak: ${t.bestStreak}</p>\n          ${t.timeElapsed?`<p>Time: ${Math.floor(t.timeElapsed/60)}:${(t.timeElapsed%60).toString().padStart(2,"0")}</p>`:""}\n        </div>\n      `,buttons:[{text:"Play Again",onClick:e,isPrimary:!0},{text:"Main Menu",onClick:n}]}).open()}getGameArea(){return this.components.gameArea}cleanup(){this.components.timer&&(this.components.timer.destroy(),this.components.timer=null),this.components.scoreDisplay&&(this.components.scoreDisplay.destroy(),this.components.scoreDisplay=null),this.components.container&&(this.components.container.innerHTML="",this.components.container=null),this.components.gameArea=null}getComponents(){return this.components}}let x={seed:null,generator:null};function S(t){null==t?(x.seed=null,x.generator=null):(x.seed=t,x.generator=function(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}(t))}function k(){return x.generator?x.generator():Math.random()}function w(t=0){const e=new Date;return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours())+t}function v(t){const e=[...t];for(let n=e.length-1;n>0;n--){const t=Math.floor(k()*(n+1));[e[n],e[t]]=[e[t],e[n]]}return e}class E{constructor(t){this.currentScenario=null,this.scenarios=[],this.container=null,this.config=t,this.stateManager=new e(t),this.resultsManager=new m(t.name),this.uiManager=new b(t)}get state(){return this.stateManager.getState()}initialize(){if(this.shouldUseSeed()){S(this.getSeed())}this.scenarios=this.generateScenarios(),S(null),this.resultsManager.startTracking()}start(){0===this.state.currentRound&&this.initialize(),this.stateManager.resume(),this.uiManager.startTimer(),this.nextRound()}pause(){this.stateManager.pause(),this.uiManager.pauseTimer()}resume(){this.stateManager.resume(),this.uiManager.resumeTimer()}reset(){this.stateManager.reset(),this.resultsManager.reset(),this.uiManager.resetTimer(),this.currentScenario=null,this.scenarios=[],this.initialize()}nextRound(){if(!this.stateManager.nextRound())return void this.endGame();const t=this.state;this.currentScenario=this.scenarios[t.currentRound-1],this.uiManager.updateScore(t.score,t.totalRounds,t.streak),this.renderScenario()}submitAnswer(t){if(!this.currentScenario||this.state.isPaused||this.state.isComplete)return!1;const e=this.checkAnswer(t,this.currentScenario.correctAnswer),n=this.config.timeLimit?this.config.timeLimit-this.uiManager.getTimerRemaining():void 0;return this.resultsManager.recordAnswer(t,e,n),e?(this.stateManager.incrementScore(),this.uiManager.incrementScore()):(this.stateManager.recordMistake(),this.uiManager.resetStreak()),this.handleAnswerFeedback(e,t),setTimeout(()=>{this.state.isPaused||this.state.isComplete||this.nextRound()},e?500:2e3),e}endGame(){this.stateManager.complete(),this.uiManager.stopTimer();const t=this.state,e=this.resultsManager.calculateResult(t);this.resultsManager.saveIfHighScore(t),this.resultsManager.recordGamePlayed(),this.uiManager.showResults(e,()=>{this.reset(),this.start()},()=>{window.location.href="/"})}getResult(){return this.resultsManager.calculateResult(this.state)}saveHighScore(){this.resultsManager.saveIfHighScore(this.state)}mount(t,e){this.container=t,this.render(t),e&&e.gameState&&!e.gameState.isComplete&&this.deserialize(e)}unmount(){this.destroy()}render(t){this.stateManager.reset(),this.resultsManager.reset(),this.scenarios=[],this.currentScenario=null,this.uiManager.setupUI(t,this.state,()=>this.handleTimeUp()),this.renderGame()}destroy(){this.uiManager.cleanup(),this.container=null}serialize(){return{gameState:this.stateManager.serialize(),currentRound:this.state.currentRound,score:this.state.score,streak:this.state.streak,bestStreak:this.state.bestStreak,scenarios:this.scenarios,currentScenario:this.currentScenario,...this.resultsManager.serialize()}}deserialize(t){t.gameState&&this.stateManager.deserialize(t.gameState),(t.answers||t.startTime)&&this.resultsManager.deserialize({answers:t.answers||[],startTime:t.startTime||0}),t.scenarios&&(this.scenarios=t.scenarios),t.currentScenario&&(this.currentScenario=t.currentScenario);const e=this.state;this.uiManager.updateScore(e.score,e.totalRounds,e.streak),e.timeRemaining&&this.uiManager.setTimerRemaining(e.timeRemaining),this.currentScenario&&this.renderScenario()}handleTimeUp(){this.endGame()}shouldUseSeed(){return!1}getSeed(){return w()}}export{E as B,S as a,h as b,w as g,d as m,v as s};
//# sourceMappingURL=BaseGame-sCkLoj0v.js.map
